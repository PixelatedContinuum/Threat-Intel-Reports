---
title: agent.exe (PoetRAT Malware) - Technical Analysis & Threat Intelligence Report
date: '2026-01-12'
layout: post
permalink: /reports/agent-exe/
hide: true
---

> **Open Directory Investigation**: This sample was discovered on an open directory hosted at IP address **109.230.231.37**, representing an active malware distribution point. The presence of multiple RAT variants on this infrastructure suggests organized malware distribution operations targeting opportunistic victims. To see all other reports from this investigation see [Executive Overview](/reports/109.230.231.37-Executive-Overview/)

**Campaign Identifier:** Arsenal-237-109.230.231.37-Malware-Repository

**Last Updated:** January 12, 2026

---

# BLUF (Bottom Line Up Front)

## Executive Summary

### Business Impact Summary
**agent.exe** is a **CRITICAL-severity Remote Access Trojan (RAT)** that matches signatures for the **PoetRAT** malware family. This 64-bit Golang-compiled malware demonstrates professional-grade development with sophisticated persistence mechanisms, anti-analysis capabilities, and a comprehensive offensive toolkit including keylogging, PowerShell execution, and remote desktop access capabilities. This sample is also new and was not submitted to virus total prior to these findings.

The malware employs **dual persistence mechanisms** masquerading as Windows Defender components, creating both startup folder entries and registry Run keys to ensure survivability across system reboots. Static analysis reveals cryptographic capabilities (AES, ChaCha20, RSA, SHA) and anti-debugging protections, while behavioral analysis shows environment-aware C2 behavior—likely remaining dormant until specific conditions are met. The malware's ability to create services, escalate privileges, and establish network listeners positions it as a **full-featured remote access platform** capable of long-term system compromise, credential theft, and lateral movement within enterprise environments.

### Key Risk Factors
<table class="professional-table">
  <thead>
    <tr>
      <th>Risk Factor</th>
      <th class="numeric">Score</th>
      <th>Business Impact</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Overall Risk</strong></td>
      <td class="numeric critical">8.7/10</td>
      <td class="critical">CRITICAL - Immediate response required</td>
    </tr>
    <tr>
      <td>Data Exfiltration Risk</td>
      <td class="numeric critical">9/10</td>
      <td>Full filesystem access + credential harvesting capabilities</td>
    </tr>
    <tr>
      <td>System Compromise</td>
      <td class="numeric critical">9/10</td>
      <td>Complete remote control + privilege escalation potential</td>
    </tr>
    <tr>
      <td>Persistence Difficulty</td>
      <td class="numeric high">8/10</td>
      <td>Dual mechanisms with legitimate process masquerading</td>
    </tr>
    <tr>
      <td>Evasion Capability</td>
      <td class="numeric high">8/10</td>
      <td>Anti-debug + environment awareness delays detection</td>
    </tr>
    <tr>
      <td>Lateral Movement Risk</td>
      <td class="numeric high">8/10</td>
      <td>RDP access + credential theft enable network pivoting</td>
    </tr>
    <tr>
      <td>Detection Difficulty</td>
      <td class="numeric critical">9/10</td>
      <td>Dormant C2 + legitimate naming + Golang obfuscation + anti-analysis features increase dwell time</td>
    </tr>
  </tbody>
</table>

### Recommended Actions
1. **ISOLATE** systems showing suspicious WinDefenderSvc.exe or WindowsDefenderUpdate entries
2. **BLOCK** distribution infrastructure: IP 109.230.231.37 at network perimeter
3. **DEPLOY** behavioral detection rules for Golang RAT indicators and dual persistence
4. **HUNT** enterprise-wide for file hashes, persistence artifacts, and .wd_installed markers
5. **ROTATE** credentials for all users on confirmed or suspected infected systems
6. **IMPLEMENT** mandatory credential rotation and assume keylogging occurred during infection window

---

## Table of Contents

- [Quick Reference](#quick-reference)
- [File Identification](#file-identification)
- [Executive Technical Summary](#executive-technical-summary)
- [Deep Technical Analysis](#deep-technical-analysis)
  - [Code Architecture & Design Philosophy](#code-architecture--design-philosophy)
  - [Persistence Mechanism Analysis](#persistence-mechanism-analysis)
  - [Command & Control Infrastructure](#command--control-infrastructure)
  - [Capabilities Deep-Dive](#capabilities-deep-dive)
- [Dynamic Sandbox Analysis](#dynamic-sandbox-analysis)
- [MITRE ATT&CK Mapping](#mitre-attck-mapping)
- [Frequently Asked Questions](#frequently-asked-questions)
- [IOCs](#iocs)
- [Detections](#detections)

---

## Quick Reference

**Detections & IOCs:**
- [agent.exe Detection Rules]({{ "/hunting-detections/agent-exe/" | relative_url }})
- [agent.exe IOCs]({{ "/ioc-feeds/agent-exe.json" | relative_url }})

---

## File Identification

- **Original Filename**: agent.exe
- **SHA256**: e7f9a29dde307afff4191dbc14a974405f287b10f359a39305dccdc0ee949385
- **SHA1**: e0fe41acd28cae74d75fcbf2f9309ff523c0f36a
- **MD5**: b1d5e55b1c15b7cb839138625d9d2efa
- **File Size**: 1,571,840 bytes (approx 1.5 MB)
- **Type**: PE32+ executable (console) x86-64, Golang-compiled
- **Family**: Matches PoetRAT malware signatures
- **Distribution Source**: IP 109.230.231.37 (CONFIRMED)

**Dropped File (Persistence Component):**
- **Filename**: WinDefenderSvc.exe
- **SHA256**: 4e856041018242c62b3848d63b94c3763beda01648d3139060700c11e9334ad1
- **Location**: %APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\

**Discovery Context**: This sample was discovered on an open directory at IP address 109.230.231.37, an active malware distribution point serving multiple RAT variants to opportunistic victims.

---

## Executive Technical Summary

### Business Context
agent.exe is a sample of the **PoetRAT malware family**, a professional-grade espionage tool. Its design prioritizes **comprehensive capability coverage** and **stealth through legitimate process masquerading**, making it particularly dangerous for organizations handling sensitive data or intellectual property.

### Key Business Impacts
- **Long-term Espionage**: Comprehensive capability set enables sustained intelligence gathering
- **Credential Harvesting**: Keylogging functionality threatens corporate credentials and multi-factor authentication
- **Network Pivoting**: PowerShell execution and RDP capabilities enable lateral movement and domain compromise
- **Regulatory Exposure**: Data exfiltration capabilities create potential GDPR, HIPAA, PCI-DSS violations

### Detection Challenges
- **Golang Compilation**: Inherent obfuscation makes reverse engineering significantly more difficult
- **Dual Persistence**: Redundant mechanisms increase likelihood of survival during partial remediation
- **Legitimate Naming**: "Windows Defender" masquerading evades casual inspection by administrators
- **Dormant C2**: Environment-aware behavior defeats time-limited sandbox analysis
- **Encrypted Communications**: Modern cryptography (AES, ChaCha20, RSA) prevents traffic inspection

### Executive Risk Assessment
**CRITICAL RISK** - agent.exe's professional development, comprehensive capability set, and sophisticated evasion mechanisms create significant risk for data breach, intellectual property theft, and long-term compromise. The Golang compilation and anti-analysis features indicate targeted development resources beyond typical commodity malware.

---

## Deep Technical Analysis

### Code Architecture & Design Philosophy

#### Deep Technical Analysis
agent.exe is compiled as a 64-bit Golang executable with sophisticated architectural design. The Golang compilation provides cross-platform portability and inherent code obfuscation that significantly complicates reverse engineering efforts. YARA signature analysis confirmed the presence of multiple advanced capabilities organized in a modular structure.

**Confirmed Capabilities (YARA Detection)**:
- **Execution Capabilities**: PowerShell command execution, service creation and management
- **Surveillance Capabilities**: Keylogging with keyboard hook implementation, RDP (Remote Desktop Protocol) access
- **Privilege Escalation**: Code patterns indicating UAC bypass or token manipulation
- **Network Capabilities**: TCP/UDP socket creation, network listener (bind shell capability)
- **Anti-Analysis Techniques**: Anti-debugging via QueryInformationProcess, ConsoleCtrlHandler manipulation, SEH (Structured Exception Handling) debugger detection
- **Cryptographic Capabilities**: AES encryption, ChaCha20 stream cipher, SHA hashing, RSA asymmetric cryptography

#### Executive Technical Context
**What This Means**: The Golang architecture enables rapid cross-platform deployment while the modular capability structure allows operators to customize functionality for specific operations. The presence of modern cryptographic algorithms (AES, ChaCha20, RSA) indicates sophisticated command and control design.

**Business Impact**: The professional code quality and extensive anti-analysis features are consistent with the PoetRAT malware family, which demonstrates characteristics of professionally developed remote access tools. This isn't opportunistic malware—it's a purpose-built espionage and remote access platform designed for long-term deployment.

**Detection Implications**:
- Traditional signature-based detection is ineffective due to Golang obfuscation and easy recompilation
- Network inspection cannot decrypt C2 communications without key material
- Behavioral detection focusing on persistence mechanisms and process characteristics is essential

**Resource Allocation**: Defending against agent.exe requires:
- Behavioral EDR solutions with Golang malware detection capabilities
- Advanced network monitoring for encrypted C2 pattern recognition
- Skilled security research team with reverse engineering expertise
- Comprehensive threat hunting program focused on persistence artifacts

### Persistence Mechanism Analysis

#### Deep Technical Analysis
agent.exe establishes **dual-redundant persistence** through complementary mechanisms targeting both user login triggers and startup folder execution. This architecture ensures malware survival even if one persistence method is discovered and removed.

**Mechanism A: Startup Folder Persistence**
- **Location**: `%APPDATA%\Microsoft\Windows\Start Menu\Programs\Startup\WinDefenderSvc.exe`
- **File Hash**: 4e856041018242c62b3848d63b94c3763beda01648d3139060700c11e9334ad1
- **Execution Timing**: User login (all users who authenticate to the compromised system)
- **Privileges Required**: User-level (no elevation needed)
- **Evasion Technique**: Masquerades as "Windows Defender Service" to avoid suspicion during manual inspection

**Mechanism B: Registry Run Key Persistence**
- **Location**: `HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run`
- **Value Name**: `WindowsDefenderUpdate`
- **Value Data**: Path to WinDefenderSvc.exe
- **Execution Timing**: User login (current user context)
- **Privileges Required**: User-level
- **Evasion Technique**: Masquerades as "Windows Defender Update" to evade scrutiny

**Installation Marker**:
- **File**: `.wd_installed` in `%LocalAppData%\Temp\` directory
- **Purpose**: Prevents duplicate installations and serves as infection flag
- **Detection Opportunity**: High-confidence indicator of compromise

#### Executive Technical Context
**What This Means**: The dual persistence approach creates **redundant survival mechanisms**—if defenders remove one persistence method, the other re-establishes execution. The legitimate Windows Defender naming is designed to exploit administrator trust in security software.

**Business Impact**:
- **Increased Dwell Time**: Dual mechanisms complicate remediation and extend attacker access window
- **Partial Cleanup Failures**: Incomplete remediation leaves backdoor access intact
- **Administrator Evasion**: Legitimate naming may allow persistence to survive manual security audits

**Detection Strategy**:
- Monitor for startup folder file creation, especially executables not signed by Microsoft
- Alert on new Run key entries with "Defender" or "Update" naming patterns
- Hunt for `.wd_installed` marker files in temporary directories
- Baseline legitimate Windows Defender file locations and digital signatures

**Remediation Complexity**: **MEDIUM** - Both persistence mechanisms must be removed simultaneously, followed by thorough hunting for additional indicators. File hash verification is critical to distinguish malicious from legitimate Windows Defender components.

### Command & Control Infrastructure

#### Deep Technical Analysis
During dynamic analysis, agent.exe demonstrated **environment-aware C2 behavior**—the malware did NOT establish outbound command and control connections despite possessing confirmed network capabilities through YARA signature detection.

**C2 Infrastructure Characteristics**:
- **Status**: NOT OBSERVED in controlled sandbox environment
- **Likely Behavior**: Environment detection followed by delayed or conditional C2 activation
- **Confirmed Capabilities**: TCP/UDP networking code, encrypted channel implementation (AES, ChaCha20)
- **Distribution Point**: IP 109.230.231.37 (confirmed malware download source)

**Environment-Aware Activation Patterns**:
1. **Sandbox Detection**: Malware may detect analysis environments through VM detection, debugger checks, or behavioral fingerprinting
2. **Time-Delayed Activation**: C2 may activate only after extended runtime exceeding typical sandbox analysis windows
3. **Geolocation-Based Filtering**: May validate victim IP address against targeting criteria before activation
4. **Infrastructure Monitoring**: Threat actors may manually authorize C2 activation for verified infections

#### Executive Technical Context
**What This Means**: The absence of observed C2 traffic does NOT indicate reduced threat severity. In real-world infections, C2 activation likely occurs hours or days after initial compromise, after the malware validates it is not in an analysis environment.

**Business Impact**:
- **Extended Dwell Time**: Delayed C2 activation increases time between infection and detection
- **Analysis Resistance**: Standard automated sandboxing cannot capture full malware behavior
- **Unknown Infrastructure**: Actual C2 servers remain unidentified, preventing network-based blocking

**Detection Strategy**:
- Implement long-term behavioral monitoring exceeding 24-48 hours for Golang executables
- Monitor for unusual encrypted outbound connections from user directories
- Deploy network anomaly detection for beaconing patterns and encrypted C2 traffic
- Hunt for process characteristics rather than relying solely on network IOCs

**Infrastructure Resilience**: **UNKNOWN** - Without observed C2 infrastructure, resilience assessment is speculative. However, the sophisticated cryptographic implementation suggests professionally managed command infrastructure.

### Capabilities Deep-Dive

> **Executive Impact Summary**
> - **Business Risk**: CRITICAL - Full system compromise with multi-vector data theft
> - **Detection Difficulty**: HIGH - Dormant C2 and process masquerading delay discovery
> - **Remediation Complexity**: HIGH - Dual persistence and unknown C2 infrastructure
> - **Key Takeaway**: This is a full-featured espionage platform, not a simple information stealer

#### Keylogging Capabilities

**CONFIRMED (YARA signature - code present, requires runtime verification)**

**Technical Implementation**:
Static analysis confirms the presence of keylogging functionality within the malware binary. Keyloggers typically use Windows API calls such as `GetAsyncKeyState()`, `SetWindowsHookEx()`, or low-level keyboard hooks to capture keystrokes.

**What This Enables**:
- **Credential Theft**: Capture usernames, passwords, and multi-factor authentication codes typed by users
- **Data Exfiltration**: Harvest sensitive business communications, intellectual property, and personal information
- **Long-term Surveillance**: Accumulate keystroke logs over weeks or months for comprehensive intelligence gathering

**Business Impact**:
Keylogging represents one of the **highest-impact capabilities** in the malware's arsenal. Compromised credentials enable:
- **Lateral Movement**: Attacker uses stolen credentials to access other systems
- **Privilege Escalation**: Stolen administrative credentials provide domain-level access
- **Persistent Access**: Even if malware is removed, stolen credentials remain valid until rotated

**Mitigation**:
- **MANDATORY credential rotation** for all users on compromised systems
- Assume credentials entered during infection period are compromised
- Implement multi-factor authentication (MFA) to reduce stolen credential effectiveness
- Deploy anti-keylogging technologies (secure input applications, virtual keyboards for sensitive entry)

#### PowerShell Execution & RDP Access

**CONFIRMED (YARA signature - code present)**

**PowerShell Execution Capability**:
- **Capability**: Execute arbitrary PowerShell commands and scripts on compromised system
- **Business Impact**: PowerShell provides full scripting access to Windows internals, enabling file system manipulation, registry editing, process control, network reconnaissance, and living-off-the-land techniques using legitimate Windows tools

**RDP Access Capability**:
- **Capability**: Enable Remote Desktop Protocol access for interactive sessions
- **Business Impact**: RDP provides attackers with full graphical user interface control, ability to use legitimate administrative tools, and persistent access even if malware is removed (if RDP account is created)

**Combined Threat**: These capabilities transform the compromised system into a **full remote administration platform** under attacker control, enabling both automated command execution and manual interactive access.

**Detection Methods**:
- Enable PowerShell Script Block Logging and Module Logging to capture PowerShell activity
- Monitor for new RDP sessions, especially from unexpected IP addresses
- Alert on user account creation or RDP user group modifications
- Analyze network traffic for unusual RDP connection patterns

#### Privilege Escalation Capabilities

**CONFIRMED (YARA signature - code present)**

Static analysis confirms the presence of privilege escalation routines, indicating the malware can attempt to elevate from standard user privileges to administrative or SYSTEM-level access.

**Common Escalation Techniques**:
- **UAC Bypass**: Exploiting Windows User Account Control weaknesses
- **Token Manipulation**: Duplicating or impersonating higher-privilege tokens
- **Exploit-Based Escalation**: Leveraging unpatched Windows vulnerabilities
- **Service Abuse**: Manipulating misconfigured Windows services

**Business Impact**:
Privilege escalation dramatically increases malware impact:
- **SYSTEM-level Persistence**: Install rootkits, modify kernel drivers, create services
- **Credential Dumping**: Access LSASS memory to extract domain credentials
- **Disable Security Controls**: Terminate antivirus processes, disable Windows Defender, delete security logs
- **Lateral Movement**: Use administrative privileges to compromise additional network systems

**Mitigation**:
- Assume privilege escalation was successful if system was running with administrative rights
- Conduct full forensic analysis to determine actual privilege level achieved
- Review security event logs for evidence of privilege escalation attempts
- Harden systems against known UAC bypass techniques

#### Encrypted Command & Control

**CONFIRMED (YARA signature - cryptographic libraries present)**

The malware includes **AES, ChaCha20, SHA, and RSA cryptographic implementations**, indicating sophisticated encrypted command and control capabilities.

**Cryptographic Architecture**:
- **AES (Advanced Encryption Standard)**: Symmetric encryption for bulk data
- **ChaCha20**: Modern stream cipher, often used for C2 session encryption
- **RSA**: Asymmetric encryption for secure key exchange
- **SHA (Secure Hash Algorithm)**: Integrity verification and message authentication

**Business Impact for Defenders**:
- **Traffic Inspection is Ineffective**: Encrypted C2 communications cannot be inspected by traditional IDS/IPS
- **Signature-Based Detection Fails**: No clear-text command strings or patterns to detect
- **SSL/TLS Decryption May Not Help**: Custom encryption (ChaCha20) operates independently of TLS
- **Forensic Reconstruction Limited**: Cannot determine which commands were issued or what data was exfiltrated from network captures alone

**Detection Methods**:
- Behavioral network analysis: Identify encrypted C2 through traffic patterns (beaconing intervals, packet sizes, connection frequencies)
- Endpoint detection: Monitor for unusual network connections combined with suspicious process behavior
- Certificate inspection: If using TLS, identify self-signed or suspicious SSL certificates

#### Anti-Debugging & Anti-Analysis

**CONFIRMED (YARA signature - anti-debug code present)**

The malware implements multiple anti-debugging techniques to hinder malware analysis and reverse engineering:

**Technique 1: QueryInformationProcess**
- **API**: `NtQueryInformationProcess` with `ProcessDebugPort` or `ProcessDebugObjectHandle`
- **Purpose**: Detect if the process is being debugged
- **Impact**: May alter behavior or terminate if debugger detected

**Technique 2: ConsoleCtrlHandler**
- **API**: `SetConsoleCtrlHandler`
- **Purpose**: Detect console manipulation or control signals used by debugging tools
- **Impact**: Can detect scripted analysis environments

**Technique 3: Structured Exception Handling (SEH)**
- **Technique**: Exception-based debugger detection
- **Purpose**: Trigger exceptions and measure handling time to detect debuggers
- **Impact**: Requires specialized debugging techniques to bypass

**Business Impact**:
- Standard automated analysis tools may fail or produce incomplete results
- Manual reverse engineering requires advanced anti-debug countermeasures
- Malware behavior may differ significantly between sandbox and production environments

#### Service Creation & Network Listener

**CONFIRMED (YARA signature - code present)**

The malware includes capabilities to:
- **Create Windows Services**: Install persistent components as system services (requires administrative privileges)
- **Open Network Listeners**: Bind to local ports to accept incoming connections (bind shell functionality)

**Business Impact**:
- **Alternate Access Method**: Even if primary C2 fails, attacker can directly connect to listening port
- **Service-Based Persistence**: More resilient than user-level persistence, survives user logoffs
- **Firewall Bypass Potential**: In some environments, outbound C2 may be blocked but inbound connections permitted

---

## Dynamic Sandbox Analysis

### Execution Timeline (Behavioral Monitoring)

#### Phase 1: Initial Execution & Installation
**Time: Analysis Start**

```
Process: agent.exe (PID: 4524)
Parent: python.exe (PID: 4008) [Analysis launcher]
Command Line: "C:\Users\<user>\.MalwareAnalysis\Samples\incoming\agent.exe"
```

#### Phase 2: Persistence Establishment

**Step 1: Primary Persistence - Startup Folder**
```
[CreateFile] agent.exe:4524 > %AppData%\Microsoft\Windows\Start Menu\Programs\Startup\WinDefenderSvc.exe
SHA256: 4e856041018242c62b3848d63b94c3763beda01648d3139060700c11e9334ad1
Purpose: User login persistence mechanism
```

**Step 2: Installation Marker Creation**
```
[CreateFile] agent.exe:4524 > %LocalAppData%\Temp\.wd_installed
SHA256: 6b86b273ff34fce19d6b804eff5a3f5747ada4eaa22f1d49c01e52ddb7875b4b
Purpose: Installation flag to prevent re-execution of setup routines
```

**Inferred Step 3: Registry Run Key Creation**
```
Registry Key: HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run
Value Name: WindowsDefenderUpdate
Value Data: %AppData%\Microsoft\Windows\Start Menu\Programs\Startup\WinDefenderSvc.exe
Purpose: Secondary persistence mechanism (redundant survivability)
```

#### Phase 3: Network Activity - Dormant Behavior

**Observed Behavior**: NO C2 TRAFFIC DETECTED

**Analysis Interpretation**:
- Malware likely employs environment detection to identify sandbox/analysis environments
- C2 activation may be time-delayed beyond typical analysis window (5+ minutes)
- May require specific system characteristics or geolocation validation before activation
- Dormant behavior is consistent with professional-grade targeted malware

### Behavioral Analysis Summary

#### Executive Technical Context
**What This Timeline Shows**: agent.exe executes a clean, methodical installation focused on stealth and persistence. The dual-mechanism persistence and environment-aware C2 behavior demonstrate professional development prioritizing long-term access over immediate command execution.

**Key Behavioral Indicators**:
1. **Stealth Installation**: Minimal observable behavior beyond persistence establishment
2. **Legitimate Process Mimicry**: Windows Defender naming to evade detection
3. **Redundant Persistence**: Dual mechanisms ensure survival
4. **Dormant C2**: Environment awareness defeats standard sandbox analysis
5. **Clean Execution**: No obvious code injection or system modification

**Business Impact**: The methodical, low-noise approach suggests malware designed for **extended dwell time** rather than immediate exploitation. This operational security focus increases detection difficulty and extends time-to-remediation.

**Detection Windows**:
- **Initial Execution**: File creation events for WinDefenderSvc.exe and .wd_installed
- **Persistence**: Startup folder monitoring and registry Run key alerting
- **Post-Installation**: Long-term monitoring for delayed C2 activation (24-48+ hours)
- **Behavioral Patterns**: Golang process characteristics combined with persistence artifacts

---

## MITRE ATT&CK Mapping

<table class="professional-table">
  <thead>
    <tr>
      <th>Tactic</th>
      <th>Technique ID</th>
      <th>Technique Name</th>
      <th>Evidence</th>
      <th>Confidence</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><strong>Execution</strong></td>
      <td>T1204.002</td>
      <td>User Execution: Malicious File</td>
      <td>Requires user to execute initial payload</td>
      <td class="confirmed">CONFIRMED</td>
    </tr>
    <tr>
      <td><strong>Execution</strong></td>
      <td>T1059.001</td>
      <td>Command and Scripting Interpreter: PowerShell</td>
      <td>YARA signature confirms PowerShell execution capability</td>
      <td class="confirmed">CONFIRMED (code present)</td>
    </tr>
    <tr>
      <td><strong>Persistence</strong></td>
      <td>T1547.001</td>
      <td>Boot or Logon Autostart Execution: Registry Run Keys / Startup Folder</td>
      <td>Confirmed creation of Run key and Startup folder entry</td>
      <td class="confirmed">CONFIRMED</td>
    </tr>
    <tr>
      <td><strong>Persistence</strong></td>
      <td>T1543.003</td>
      <td>Create or Modify System Process: Windows Service</td>
      <td>YARA signature confirms service creation capability</td>
      <td class="confirmed">CONFIRMED (code present)</td>
    </tr>
    <tr>
      <td><strong>Privilege Escalation</strong></td>
      <td>T1068</td>
      <td>Exploitation for Privilege Escalation</td>
      <td>YARA signature confirms privilege escalation code present</td>
      <td class="confirmed">CONFIRMED (code present)</td>
    </tr>
    <tr>
      <td><strong>Defense Evasion</strong></td>
      <td>T1036.005</td>
      <td>Masquerading: Match Legitimate Name or Location</td>
      <td>Uses "WinDefenderSvc.exe" and "WindowsDefenderUpdate" naming</td>
      <td class="confirmed">CONFIRMED</td>
    </tr>
    <tr>
      <td><strong>Defense Evasion</strong></td>
      <td>T1622</td>
      <td>Debugger Evasion</td>
      <td>YARA detections for anti-debug API calls (QueryInfo, SEH, ConsoleCtrl)</td>
      <td class="confirmed">CONFIRMED</td>
    </tr>
    <tr>
      <td><strong>Defense Evasion</strong></td>
      <td>T1027</td>
      <td>Obfuscated Files or Information</td>
      <td>Golang compilation provides inherent obfuscation; cryptographic capabilities</td>
      <td class="confirmed">CONFIRMED</td>
    </tr>
    <tr>
      <td><strong>Credential Access</strong></td>
      <td>T1056.001</td>
      <td>Input Capture: Keylogging</td>
      <td>YARA signature confirms keylogging code present</td>
      <td class="confirmed">CONFIRMED (code present)</td>
    </tr>
    <tr>
      <td><strong>Discovery</strong></td>
      <td>T1082</td>
      <td>System Information Discovery</td>
      <td>Inferred from environment-aware behavior (dormant C2)</td>
      <td class="confirmed">LIKELY</td>
    </tr>
    <tr>
      <td><strong>Lateral Movement</strong></td>
      <td>T1021.001</td>
      <td>Remote Services: Remote Desktop Protocol</td>
      <td>YARA signature confirms RDP access capability</td>
      <td class="confirmed">CONFIRMED (code present)</td>
    </tr>
    <tr>
      <td><strong>Collection</strong></td>
      <td>T1005</td>
      <td>Data from Local System</td>
      <td>Inferred from keylogging and remote access capabilities</td>
      <td class="confirmed">LIKELY</td>
    </tr>
    <tr>
      <td><strong>Command and Control</strong></td>
      <td>T1071.001</td>
      <td>Application Layer Protocol: Web Protocols</td>
      <td>Inferred from network capabilities; likely HTTPS-based C2</td>
      <td class="confirmed">LIKELY</td>
    </tr>
    <tr>
      <td><strong>Command and Control</strong></td>
      <td>T1573</td>
      <td>Encrypted Channel</td>
      <td>AES, ChaCha20, RSA cryptographic libraries present</td>
      <td class="confirmed">CONFIRMED</td>
    </tr>
    <tr>
      <td><strong>Exfiltration</strong></td>
      <td>T1041</td>
      <td>Exfiltration Over C2 Channel</td>
      <td>Inferred from encrypted C2 capabilities</td>
      <td class="confirmed">LIKELY</td>
    </tr>
  </tbody>
</table>

---

## Frequently Asked Questions

### Technical Questions

**Q: Why didn't the malware establish C2 connections during analysis?**
A: agent.exe demonstrates environment-aware behavior typical of professional-grade malware. It likely detects sandbox/analysis environments through VM detection, timing checks, or system fingerprinting and remains dormant to evade detection. In real-world infections, C2 activation may occur hours or days after initial compromise.

**Q: How does Golang compilation affect detection and analysis?**
A: Golang provides inherent code obfuscation, larger binary sizes that complicate analysis, cross-platform compilation capabilities, and built-in runtime that makes reverse engineering more difficult compared to C/C++ binaries. Traditional signature-based detection is less effective against Golang malware.

**Q: What makes the dual persistence mechanism effective?**
A: Redundant persistence creates self-healing capability—even if security tools or administrators remove one mechanism (e.g., startup folder file), the other (e.g., registry Run key) re-establishes execution on next login. Complete remediation requires simultaneous removal of both mechanisms.

**Q: How dangerous is the keylogging capability?**
A: CRITICAL. Keylogging enables theft of passwords, MFA codes, sensitive communications, and intellectual property. Compromised credentials provide attackers with persistent access even after malware removal. MANDATORY credential rotation is required for all users on infected systems.

### Business Questions

**Q: Should we rebuild infected systems or attempt cleanup?**
A: **REBUILD STRONGLY RECOMMENDED**. Given the professional-grade development, unknown C2 infrastructure, potential privilege escalation, and comprehensive capabilities, complete system rebuild provides the only high-confidence remediation. Cleanup approaches carry significant residual risk of incomplete eradication.

**Q: What are the compliance implications of this infection?**
A: Significant. Keylogging and data exfiltration capabilities create potential violations of:
- **GDPR**: Unauthorized access to personal data, potential data breach notification requirements
- **HIPAA**: Protected health information exposure if healthcare data accessible
- **PCI-DSS**: Payment card data compromise if financial systems affected
- **SOX**: Financial data integrity concerns for publicly traded companies

**Q: How can we detect this malware if it evades traditional antivirus?**
A: Implement behavioral EDR solutions, monitor for startup folder file creation and registry Run key modifications, hunt for .wd_installed marker files, deploy Golang-specific malware detection signatures, and use provided YARA/Sigma detection rules. Focus on behavioral indicators rather than static signatures.

**Q: What is the estimated remediation timeline?**
A: For REBUILD approach:
- **Immediate Actions** (0-4 hours): Network isolation, evidence preservation, threat hunting
- **Investigation** (4-24 hours): Forensic analysis, scope determination, credential impact assessment
- **Remediation** (1-3 days): System rebuild, credential rotation, security control enhancement
- **Validation** (3-7 days): Monitoring for reinfection, verification of cleanup effectiveness

---

## IOCs
- [agent.exe IOCs]({{ "/ioc-feeds/agent-exe.json" | relative_url }})

## Detections
- [agent.exe Detection Rules]({{ "/hunting-detections/agent-exe/" | relative_url }})

---

## License
© 2026 Joseph. All rights reserved.
Free to read, but reuse requires written permission.
